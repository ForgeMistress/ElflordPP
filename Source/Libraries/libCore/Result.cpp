///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//  Result.cpp
//
//  A result of an operation.
//
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Copyright (c) Project Elflord 2018
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "stdafx.h"
#include "Result.h"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

OPEN_NAMESPACE(Firestorm);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::Error()
: _code(nullptr)
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::Error(const ErrorCode* errorCode, const string& details)
: _code(errorCode)
, _details(details)
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::Error(const Error& error)
: _code(error._code)
, _details(error._details)
{
}

Error::Error(Error&& other)
: _code(other._code)
, _details(std::move(other._details))
{
	other._code = nullptr;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::operator string() const
{
	string s;
	s.append_sprintf("[%d] ERROR %s", _code->_code, _code->_message);
	
	if(!_details.empty())
		s.append_sprintf("\n    DETAILS: %s", _details);
	return s;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::operator uint32_t() const
{
	return _code->_code;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error& Error::operator=(const Error& e)
{
	if(this != &e)
	{
		_code = e._code;
		_details = e._details;
	}
	return *this;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

bool Error::operator==(const Error& e) const
{
	return _code->_code == e._code->_code;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void Error::Set(const ErrorCode* code, const string& details)
{
	_code = code;
	_details = details;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Error::operator bool() const
{ 
	return _code != nullptr;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

uint32_t ErrorCode::s_errorCodes = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

ErrorCode::ErrorCode(const string& message)
: _code(++s_errorCodes)
, _message(message)
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

ErrorCode::operator string() const 
{ 
	return _message; 
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

ErrorCode::operator const string&() const
{ 
	return _message; 
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

ErrorCode::operator uint32_t() const
{ 
	return _code;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

CLOSE_NAMESPACE(Firestorm);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////